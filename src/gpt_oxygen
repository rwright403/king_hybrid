import matplotlib.pyplot as plt
import numpy as np
import CoolProp.CoolProp as CP

# Set fluids
fluid_oxygen = 'Oxygen'
fluid_kerosene = 'Dodecane'  # Dodecane as a representative for kerosene

# Create temperature ranges
T_min_oxygen = CP.PropsSI('Ttriple', fluid_oxygen)
T_max_oxygen = CP.PropsSI('Tcrit', fluid_oxygen)
temperatures_oxygen = np.linspace(T_min_oxygen, T_max_oxygen, 500)

T_min_kerosene = 200  # in Kelvin
T_max_kerosene = CP.PropsSI('Tcrit', fluid_kerosene)
temperatures_kerosene = np.linspace(T_min_kerosene, T_max_kerosene, 500)

# Arrays to store pressure values
pressures_oxygen_liquid = []
pressures_oxygen_vapor = []
pressures_kerosene_liquid = []
pressures_kerosene_vapor = []

# Calculate the saturation pressures for oxygen
for T in temperatures_oxygen:
    p_sat = CP.PropsSI('P', 'T', T, 'Q', 0, fluid_oxygen)
    pressures_oxygen_liquid.append(p_sat)

# Calculate the saturation pressures for kerosene (dodecane)
for T in temperatures_kerosene:
    try:
        p_sat_liq = CP.PropsSI('P', 'T', T, 'Q', 0, fluid_kerosene)
        pressures_kerosene_liquid.append(p_sat_liq)
        p_sat_vap = CP.PropsSI('P', 'T', T, 'Q', 1, fluid_kerosene)
        pressures_kerosene_vapor.append(p_sat_vap)
    except:
        pressures_kerosene_liquid.append(np.nan)
        pressures_kerosene_vapor.append(np.nan)

# Plot the phase diagrams
plt.figure(figsize=(12, 8))
plt.plot(temperatures_oxygen, pressures_oxygen_liquid, label='Oxygen - Saturated Liquid-Vapor', color='blue')
plt.plot(temperatures_kerosene, pressures_kerosene_liquid, label='Kerosene (Dodecane) - Saturated Liquid', color='green')
plt.plot(temperatures_kerosene, pressures_kerosene_vapor, label='Kerosene (Dodecane) - Saturated Vapor', color='orange')

# Highlight critical points
T_crit_oxygen = CP.PropsSI('Tcrit', fluid_oxygen)
P_crit_oxygen = CP.PropsSI('Pcrit', fluid_oxygen)
plt.scatter([T_crit_oxygen], [P_crit_oxygen], color='red', label='Oxygen Critical Point')

T_crit_kerosene = CP.PropsSI('Tcrit', fluid_kerosene)
P_crit_kerosene = CP.PropsSI('Pcrit', fluid_kerosene)
plt.scatter([T_crit_kerosene], [P_crit_kerosene], color='purple', label='Kerosene (Dodecane) Critical Point')

# Add labels and title
plt.yscale('log')
plt.xlabel('Temperature [K]')
plt.ylabel('Pressure [Pa]')
plt.title('Phase Diagrams for Oxygen and Kerosene (Using Dodecane)')
plt.legend()
plt.grid(True)

# Show plot
plt.show()
